# name: test/sql/read_otlp_limits.test
# description: test file handling and basic limits
# group: [sql]

require otlp

### Basic File Reading ###

# Test normal file
query I
SELECT COUNT(*) FROM read_otlp_traces('test/data/traces_simple.jsonl');
----
3

# Test large attributes file
query I
SELECT COUNT(*) FROM read_otlp_traces('test/data/traces_large_attrs.jsonl');
----
1

# Test deep nesting file
query I
SELECT COUNT(*) FROM read_otlp_traces('test/data/traces_deep_nesting.jsonl');
----
1

### Logs and Metrics ###

# Test logs
query I
SELECT COUNT(*) FROM read_otlp_logs('test/data/logs_simple.jsonl');
----
3

# Test gauge metrics
query I
SELECT COUNT(*) FROM read_otlp_metrics_gauge('test/data/metrics_simple.jsonl');
----
1

# Test sum metrics
query I
SELECT COUNT(*) FROM read_otlp_metrics_sum('test/data/metrics_simple.jsonl');
----
1

### Boundary Conditions ###

# Test zero duration (nulls traces have no duration)
query I
SELECT COUNT(*) FROM read_otlp_traces('test/data/traces_nulls.jsonl')
WHERE duration = 0;
----
3

### Multiple Files with Glob Patterns ###

# Test glob pattern with traces
query I
SELECT COUNT(*) FROM read_otlp_traces('test/data/traces_*.jsonl');
----
8

### Edge Case: Single Minimal Record ###

# Test single trace record
query I
SELECT COUNT(*) FROM read_otlp_traces('test/data/single_trace.jsonl');
----
1
