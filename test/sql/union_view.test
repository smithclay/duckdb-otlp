# name: test/sql/union_view.test
# description: Test otel_metrics_union view in ATTACH mode
# group: [duckspan]

require duckspan

# ATTACH in-memory OTLP storage
statement ok
ATTACH 'otlp:localhost:4318' AS test (TYPE otlp);

# Verify the union table function exists and returns zero rows
query I
SELECT COUNT(*) FROM otlp_metrics_union('test');
----
0

# Should be able to project typical columns (validate compile-time names)
statement ok
SELECT Timestamp, ServiceName, MetricName, MetricType FROM otlp_metrics_union('test') LIMIT 0;

# Clean up
statement ok
DETACH test;
