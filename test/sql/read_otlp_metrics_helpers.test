# name: test/sql/read_otlp_metrics_helpers.test
# description: verify read_otlp_metrics_* helper functions
# group: [duckspan]

require otlp

# Gauge helper
query I
SELECT COUNT(*) FROM read_otlp_metrics_gauge('test/data/metrics_simple.jsonl');
----
1

query I
SELECT CAST(value AS BIGINT) FROM read_otlp_metrics_gauge('test/data/metrics_simple.jsonl');
----
524288000

# Sum helper
query I
SELECT COUNT(*) FROM read_otlp_metrics_sum('test/data/metrics_simple.jsonl');
----
1

query I
SELECT is_monotonic FROM read_otlp_metrics_sum('test/data/metrics_simple.jsonl');
----
true
