# name: test/sql/read_otlp_malformed.test
# description: test error handling with malformed/invalid OTLP data
# group: [sql]

require otlp

### Malformed JSON - Default Error Handling ###

# Test malformed JSON should error
statement error
SELECT * FROM read_otlp_traces('test/data/malformed.jsonl');
----

### Nonexistent File Handling ###

# Test nonexistent file with fail mode
statement error
SELECT * FROM read_otlp_traces('test/data/does_not_exist.jsonl');
----

# Test nonexistent file with logs
statement error
SELECT * FROM read_otlp_logs('test/data/does_not_exist.jsonl');
----

# Test nonexistent file with metrics
statement error
SELECT * FROM read_otlp_metrics('test/data/does_not_exist.jsonl');
----

### Error Handling with Different Data Types ###

# Test malformed traces
statement error
SELECT * FROM read_otlp_traces('test/data/malformed.jsonl');
----

# Test malformed logs
statement error
SELECT * FROM read_otlp_logs('test/data/malformed.jsonl');
----

# Test malformed metrics
statement error
SELECT * FROM read_otlp_metrics('test/data/malformed.jsonl');
----
