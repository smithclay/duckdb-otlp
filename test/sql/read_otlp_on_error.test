# name: test/sql/read_otlp_on_error.test
# description: Verify read_otlp error handling
# group: [duckspan]

require otlp

# Default behaviour should fail on malformed input
statement error
SELECT COUNT(*) FROM read_otlp_traces('test/data/malformed.jsonl');
----

# Valid files should parse successfully
query I
SELECT COUNT(*) FROM read_otlp_traces('test/data/traces_simple.jsonl');
----
3

query I
SELECT COUNT(*) FROM read_otlp_logs('test/data/logs_simple.jsonl');
----
3

# Test gauge metrics
query I
SELECT COUNT(*) FROM read_otlp_metrics_gauge('test/data/metrics_simple.jsonl');
----
1

# Test sum metrics
query I
SELECT COUNT(*) FROM read_otlp_metrics_sum('test/data/metrics_simple.jsonl');
----
1
